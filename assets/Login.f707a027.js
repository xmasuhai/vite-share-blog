import{b as g,k as a,u as w,c as v,e as s,w as L,x as k,A as y,F as U}from"./vendor.c3c68332.js";import{u as T}from"./index.b8bcac15.js";import{u as n}from"./useIfLoading.c2be5f1a.js";import{u as E,a as H,c as I,U as p,b as x,m as S}from"./mask-layer.module.5b05032e.js";const b={};var $=g({name:"Login",props:b,components:{},setup(){const e=a(!1);E().then(),H();const h=T(),u=w(),l=a(""),c=a(""),m=a("admin001"),f=a("123456"),d=v(()=>({username:l.value,password:c.value})),o=a(!1),i=async r=>{e.value=!0,o.value=!1;const t=await h.login(r);return t.isLogin&&t.data?(e.value=n().value,u.push({path:u.currentRoute.value.query.redirect||"/"}).then(()=>{console.log("useIfLoading().value",n().value),e.value=n().value})):(t.status==="fail"&&(o.value=!0),e.value=n().value),t};return{username:l,password:c,defaultUsername:m,defaultPassword:f,userLoginInfo:d,onLogin:i,keyUpHandler:r=>{["Enter"].includes(r.key)&&i(d.value)},clickHandler:async r=>{await i(r)},isLoading:e,showError:o}},render(){return s(U,null,[s("section",{class:I.login},[s(p,{title:"\u7528\u6237\u540D",errorText:"\u5F53\u524D\u7528\u6237\u540D\u6216\u5BC6\u7801\u4E0D\u5339\u914D",username:this.username,"onUpdate:username":e=>this.username=e,placeholder:`\u9ED8\u8BA4\u767B\u5F55\u540D\uFF1A${this.defaultUsername}`,showError:this.showError},null),s(p,{title:"\u5BC6\u7801",inputType:"password",errorText:"\u5F53\u524D\u7528\u6237\u540D\u6216\u5BC6\u7801\u4E0D\u5339\u914D",password:this.password,"onUpdate:password":e=>this.password=e,onKeyUp:this.keyUpHandler,placeholder:`\u9ED8\u8BA4\u5BC6\u7801\uFF1A${this.defaultPassword}`,showError:this.showError},null),s(x,{btnName:"\u7ACB\u5373\u767B\u5F55",tipText:"\u6CA1\u6709\u8D26\u53F7\uFF1F",linkTo:"/register",linkText:"\u6CE8\u518C\u65B0\u7528\u6237",onHandleSubmit:async()=>{await this.clickHandler(this.userLoginInfo)}},null)]),L(s("section",{class:S.mask},[s(y,{tip:"Loading...",size:"large",spinning:this.isLoading},null)]),[[k,this.isLoading]])])}});export{$ as default};
