import{b as L,u as k,t as P,k as g,v as $,e,w as b,x as y,F as p,j as w,i as B,f as C,r as S}from"./vendor.c3c68332.js";import{U as x,b as D}from"./beautifyDate.a1c18d64.js";import{u as U,b as s,a as j}from"./useRenderMultiSkeleton.e44f1279.js";import{u as N}from"./useIfLoading.4a4d055b.js";import{g as R}from"./blog.75390598.js";import{s as A}from"./scrollToTop.c4b43072.js";import"./index.b2d1c1d8.js";function T(i){return typeof i=="function"||Object.prototype.toString.call(i)==="[object Object]"&&!w(i)}var _=L({name:"BlogIndex",props:{},setup(){const i=N(),m=k(),f=P(),c=g([]),d=g(0),t=g(1),a=g(20),o=async l=>{const{data:u,total:h,totalPage:I,page:v}=await R({page:l});return u&&(c.value=u),h&&I&&(d.value=a.value*I),v&&(t.value=v),{blogList:u,totalPage:I,page:v}},r=async()=>{t.value=parseInt(f.query.page)||1,await o(t.value)},n=async l=>{A(),await o(l),await m.push({path:"/",query:{page:l}})};return $(async()=>{A(),await r()}),{blogDataList:c,currentPage:t,allPages:d,pageSize:a,getBlogList:r,onPageChange:n,loading:i}},render(){const i=t=>{const{user:a}=t,{avatar:o,id:r,username:n}=a;return e(p,null,[e("figure",{class:s.avatar},[e(x,{userId:r},{default:()=>[e("img",{class:s.img,src:o,alt:n},null)]}),e("figcaption",{class:s.info},[e(x,{userId:r},T(n)?n:{default:()=>[n]})])])])},m=t=>{const{createdAt:a,description:o,title:r}=t;return e(p,null,[e("h3",{class:s.title},[e("span",{class:s.text},[r]),e("span",{class:s.date},[`${D(a)}`,B(" ")])]),e("p",{class:C([s.description,s.omitText])},[o])])},f=t=>{const{id:a}=t;return e("p",{class:s.detailLink},[e(S("router-link"),{to:`/detail/${a}`},{default:()=>[B("\u8BE6\u7EC6 >>>")]})])},c=t=>{const{updatedAt:a,createdAt:o,id:r,user:n}=t,{id:l,updatedAt:u,createdAt:h}=n;return b(e("article",{class:s.item,key:`${r}${l}${a}${o}${u}${h}`},[i(t),m(t),f(t)]),[[y,!this.loading]])},d=t=>b(e("section",{class:"article-list"},[t.map(a=>e(p,null,[c(a)]))]),[[y,!this.loading]]);return e(p,null,[this.loading&&U(this.loading,"others",()=>{},!0,!0,!0,!1),this.blogDataList&&d(this.blogDataList),j(this.allPages,this.pageSize,this.currentPage,this.onPageChange)])}});export{_ as default};
