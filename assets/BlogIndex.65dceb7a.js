import{d as x,r as g,o as P,c as e,F as p,w as b,v as y,u as $,a as k,b as B,e as w,f as C,i as S}from"./index.2faee0b7.js";import{U as A,b as D}from"./beautifyDate.de027194.js";import{u as U,a as N,b as s}from"./useRenderMultiSkeleton.e1bcb352.js";import{u as R}from"./useIfLoading.b15d66fa.js";import{g as T}from"./blog.0a584fe5.js";import{s as L}from"./scrollToTop.b6788b2e.js";import"./index.9563d230.js";import"./KeyCode.e4ba36c3.js";import"./SearchOutlined.d0864de1.js";import"./isSymbol.a0d89b8f.js";function j(i){return typeof i=="function"||Object.prototype.toString.call(i)==="[object Object]"&&!S(i)}var J=x({name:"BlogIndex",props:{},setup(){const i=R(),m=$(),f=k(),c=g([]),d=g(0),t=g(1),a=g(20),o=async l=>{const{data:u,total:h,totalPage:I,page:v}=await T({page:l});return u&&(c.value=u),h&&I&&(d.value=a.value*I),v&&(t.value=v),{blogList:u,totalPage:I,page:v}},r=async()=>{t.value=parseInt(f.query.page)||1,await o(t.value)},n=async l=>{L(),await o(l),await m.push({path:"/",query:{page:l}})};return P(async()=>{L(),await r()}),{blogDataList:c,currentPage:t,allPages:d,pageSize:a,getBlogList:r,onPageChange:n,loading:i}},render(){const i=t=>{const{user:a}=t,{avatar:o,id:r,username:n}=a;return e(p,null,[e("figure",{class:s.avatar},[e(A,{userId:r},{default:()=>[e("img",{class:s.img,src:o,alt:n},null)]}),e("figcaption",{class:s.info},[e(A,{userId:r},j(n)?n:{default:()=>[n]})])])])},m=t=>{const{createdAt:a,description:o,title:r}=t;return e(p,null,[e("h3",{class:s.title},[e("span",{class:s.text},[r]),e("span",{class:s.date},[`${D(a)}`,B(" ")])]),e("p",{class:w([s.description,s.omitText])},[o])])},f=t=>{const{id:a}=t;return e("p",{class:s.detailLink},[e(C("router-link"),{to:`/detail/${a}`},{default:()=>[B("\u8BE6\u7EC6 >>>")]})])},c=t=>{const{updatedAt:a,createdAt:o,id:r,user:n}=t,{id:l,updatedAt:u,createdAt:h}=n;return b(e("article",{class:s.item,key:`${r}${l}${a}${o}${u}${h}`},[i(t),m(t),f(t)]),[[y,!this.loading]])},d=t=>b(e("section",{class:"article-list"},[t.map(a=>e(p,null,[c(a)]))]),[[y,!this.loading]]);return e(p,null,[this.loading&&U(this.loading,"others",()=>{},!0,!0,!0,!1),this.blogDataList&&d(this.blogDataList),N(this.allPages,this.pageSize,this.currentPage,this.onPageChange)])}});export{J as default};
